# SRS — Telegram Бот Обучения (Combinatorics Bot)

## 1. Введение

### 1.1 Назначение документа
Данный документ описывает требования к бэкенду Telegram-бота, который предназначен для обучения комбинаторике тюркских языков.  
Документ разрабатывался для разработчиков, тестировщиков и группы сопровождения системы.

### 1.2 Область применения продукта
#### 1.2.1 Назначение продукта
Продукт представляет собой бекенд часть Telegram-бота, который предназначен для пользователей Telegram изучающих тюркские языки(далее будем рассматривать на примере татарского) и находящихся на начальном уровне изучения. Предназначен для улучшения навыка построения простых предложений.
Telegram-бот предоставляет список упражнений расположенных по возрастанию сложности.
Каждое упражнение - это набор заданий в формате требования перевести предложение на изучаемый язык (далее вопрос), где правильный перевод предложения состовляется из последовательности слов или частей слов(далее подвопросы), каждый из которых выбирается из набора вариантов ответов(далее варианты).
#### 1.2.2 Среда эксплуатации
Продукт функционирует в составе экосистемы Telegram и включает следующие компоненты:
- клиентскую часть в виде Telegram-приложения (мобильного или десктопного);
- бэкенд Telegram-бота, реализованный на языке Go;
- базу данных SQLite для хранения учебных данных;
- взаимодействие с пользователем осуществляется через Telegram Bot API.



- последовательно задаёт вопросы пользователю;
- принимает ответы в виде inline-кнопок;
- проверяет правильность ответа;
- управляет переходами между подвопросами и вопросами;
- поддерживает вспомогательные текстовые вставки (pointing / препинание).

### 1.3 Термины и определения
- **Question** — основной вопрос упражнения  
- **SubQuestion** — шаг внутри вопроса  
- **Option** — вариант ответа  
- **pointing** — флаг, указывающий на наличие текстовой вставки между вопросами  
- **prepinanie** — текстовая вставка (например, пробел или поясняющий текст)

---

## 2. Общее описание
Telegram-бот представляет из себя список упражнений расположенных по возрастанию сложности.
Каждое упражнение - это набор заданий в формате требования перевести предложение на изучаемый язык (далее вопрос), где правильный перевод предложения состовляется из последовательности ответов(далее подвопросы), каждый из которых выбирается из набора вариантов ответов(далее варианты).

### 2.1 Пользователи
- Конечный пользователь: ученик / студент, он же пользователь телеграмм-бота
- Технический пользователь: администратор
- Административный пользователь: Учитель

### 2.2 Ограничения
- Бот работает в Telegram
- Хранение данных осуществляется в SQLite
- Бизнес-логика реализована на Go

---

## 3. Функциональные требования

### FR-1 Выбор раздела
**Описание:**  
Пользователь может выбрать раздел обучения (например, «Комбинаторика»).

**Вход:**  
Inline-кнопка `Combinatorics`

**Результат:**  
Отображается список упражнений

---

### FR-2 Выбор упражнения
**Описание:**  
Пользователь выбирает упражнение.

**Вход:**  
`CallbackQuery.Data = ExerciseID=<id>`

**Результат:**  
Отображается первый вопрос упражнения

---

### FR-3 Ответ на вопрос
**Описание:**  
Пользователь выбирает вариант ответа.

**Вход:**  
`CallbackQuery.Data = ansID=<option_id>`

**Результат:**  
- Проверяется правильность ответа
- Обновляется текст сообщения
- Отображается следующий вопрос или подвопрос

---

### FR-4 Проверка правильности ответа
**Описание:**  
Система определяет, совпадает ли выбранный вариант с правильным ответом.

**Результат:**
- При верном ответе — переход к следующему шагу
- При неверном — подсветка ошибочного варианта ❌

---

### FR-5 Поддержка pointing / prepinanie
**Описание:**  
Если следующий `SubQuestion` имеет `pointing = 1`, перед ним вставляется текст `prepinanie`.

**Примечание:**  
Если `prepinanie` отсутствует, используется пустая строка.

---

### FR-6 Завершение вопроса
**Описание:**  
Если текущий `SubQuestion` последний, бот автоматически переходит к следующему `Question`.

---

## 4. Требования к данным

### 4.1 Сущности

#### Question
- `id`
- `text`
- `exercise_id`

#### SubQuestion
- `id`
- `question_id`
- `text`
- `seq_num`
- `pointing`

#### Option
- `id`
- `sub_question_id`
- `text`

---

## 5. Нефункциональные требования

### NFR-1 Производительность
- Ответ бота ≤ 1 секунды

### NFR-2 Надёжность
- Бот не должен падать при отсутствии данных
- NULL-значения обрабатываются через COALESCE

### NFR-3 Поддерживаемость
- SQL-запросы изолированы
- Логика переходов реализована в Go

---

## 6. Граничные случаи

- Нет следующего `SubQuestion`
- Нет следующего `Question`
- `prepinanie` = NULL
- Пользователь нажал кнопку повторно

---

## 7. Трассируемость требований

| Требование | Реализация |
|-----------|-----------|
| FR-3 | `handleCallbackQuery()` |
| FR-4 | `ActuallyAnswer()` |
| FR-5 | SQL `CASE + COALESCE` |
| FR-6 | Проверка `lastSubquestion` |

---

## 8. Будущие улучшения

- Поддержка статистики ответов
- Несколько упражнений подряд
- Web-интерфейс администратора